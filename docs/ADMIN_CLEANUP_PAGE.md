# 수동 정리 관리 페이지

## 접근 방법

```
http://localhost:3000/dev/admin/cleanup
```

## 페이지 기능

### 1. 정리 작업 실행
- **버튼**: "정리 작업 실행" 버튼 클릭
- **동작**: 만료된 선점 좌석을 즉시 정리
- **결과**: 정리된 좌석 수 및 목록 표시

### 2. 실행 결과 확인

#### 성공 시
- ✅ 체크 아이콘과 함께 성공 메시지 표시
- 정리된 좌석 수 표시
- 정리된 좌석 목록 (좌석 라벨, 콘서트 ID)
- 실행 시간 기록

#### 실패 시
- ⚠️ 경고 아이콘과 함께 오류 메시지 표시
- 에러 상세 정보 제공

#### 정리 대상 없음
- ⏱️ 시계 아이콘과 함께 안내 메시지
- "만료된 선점 좌석이 없습니다"

### 3. 정보 패널
- **자동 실행**: Vercel Cron Job에 의한 1분마다 자동 실행
- **마지막 상태**: 이전 실행 결과 (성공/실패)
- **정리 대상**: temporarily_held 상태 + 만료된 좌석

## 사용 시나리오

### 테스트 환경
```bash
# 1. 개발 서버 시작
npm run dev

# 2. 브라우저에서 접근
http://localhost:3000/dev/admin/cleanup

# 3. "정리 작업 실행" 버튼 클릭
# 4. 결과 확인
```

### 프로덕션 검증
- Vercel 배포 후 Function Logs에서 Cron Job 실행 확인
- 필요시 이 페이지에서 수동 실행하여 검증

## 응답 형식

### 성공 (200)
```json
{
  "ok": true,
  "data": {
    "message": "Successfully cleaned up 5 expired seat holds",
    "clearedCount": 5,
    "expiredSeats": [
      {
        "id": "seat-uuid-1",
        "label": "A1-001",
        "concertId": "concert-uuid-1"
      }
    ]
  }
}
```

### 실패 (500)
```json
{
  "ok": false,
  "error": {
    "code": "CLEANUP_FAILED",
    "message": "Failed to update expired holds: ..."
  }
}
```

## 주의사항

1. **개발 환경에서만**: 프로덕션에서는 접근 제한 필요
2. **로그 확인**: 작업 실행 결과는 서버 로그에도 기록됨
3. **반복 실행**: 같은 좌석을 여러 번 정리할 수 없음 (이미 available 상태)
4. **데이터 무결성**: 좌석 상태 변경은 트랜잭션 안전하게 처리됨

## 페이지 구성

```
┌─────────────────────────────────────┐
│ 헤더: 관리 대시보드                     │
├─────────────────────────────────────┤
│ 설명: 선점 정리 시스템 안내             │
├─────────────────────────────────────┤
│ 버튼: "정리 작업 실행"                 │
├─────────────────────────────────────┤
│ 결과 영역 (성공/실패/정보)             │
├─────────────────────────────────────┤
│ 정리된 좌석 목록 (가능하면)            │
├─────────────────────────────────────┤
│ 하단 정보: 자동 실행, 상태, 정리 대상   │
└─────────────────────────────────────┘
```

## 개발자 노트

### 파일 위치
- 페이지: `src/app/dev/admin/cleanup/page.tsx`
- 레이아웃: `src/app/dev/admin/layout.tsx`
- 홈: `src/app/dev/page.tsx`

### API 엔드포인트
- `POST /api/jobs/cleanup-expired-holds`

### 컴포넌트 의존성
- `Button` - UI 버튼
- `Card` - 카드 컨테이너
- `Alert Icons` - 상태 표시용 아이콘
- `apiClient` - Axios 기반 HTTP 클라이언트
